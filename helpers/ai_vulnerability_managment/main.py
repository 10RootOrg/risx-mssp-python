import requests
from datetime import datetime, timedelta

def get_cves(keyword, start_date, end_date):
    base_url = 'https://services.nvd.nist.gov/rest/json/cves/2.0'
    params = {
        'keywordSearch': keyword,
        'pubStartDate': start_date.strftime('%Y-%m-%dT%H:%M:%S:000 UTC+00:00'),
        'pubEndDate': end_date.strftime('%Y-%m-%dT%H:%M:%S:000 UTC+00:00'),
    }

    response = requests.get(base_url, params=params)
    if response.status_code == 200:
        data = response.json()
        return data.get('vulnerabilities', [])
    else:
        print(f"Error fetching CVEs for {keyword}: {response.status_code}")
        return []

def main():
    end_date = datetime.utcnow()
    start_date = end_date - timedelta(days=30)

    search_terms = ["Windows 11", "Windows Server 2016", "CrowdStrike Falcon"]

    for term in search_terms:
        print(f"\nSearching CVEs for {term} between {start_date.date()} and {end_date.date()}:")
        cves = get_cves(term, start_date, end_date)

        if cves:
            for cve in cves:
                cve_id = cve['cve']['id']
                description = cve['cve']['descriptions'][0]['value']
                print(f"{cve_id}: {description}\n")
        else:
            print("No CVEs found.")

if __name__ == "__main__":
    main()