id: CVE-WordPress-Test3-CVE-2025-3247
info:
  name: Contact Form 7 Order Replay Vulnerability
  author: Security Researcher
  severity: medium
  description: Detects an Order Replay vulnerability in the Contact Form 7 plugin for WordPress (≤ 6.0.5) via the `wpcf7_stripe_skip_spam_check` function, which allows unauthenticated attackers to reuse a single Stripe PaymentIntent for multiple transactions, potentially enabling fraudulent charges or double billing. :contentReference[oaicite:0]{index=0}
  tags:
    - cve
    - wordpress
    - plugin
    - contact-form-7
    - stripe
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-3247
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/38257dbf-288e-4028-af65-85f5389888ac?source=cve
requests:
  - method: GET
    path:
      - '{BaseURL}/'
    matchers:
      - type: regex
        part: body
        regex:
          # Matches inclusion of CF7 CSS asset with version ≤ 6.0.5
          - 'wp-content/plugins/contact-form-7/includes/css/styles\.css\?ver=(?:[0-5]\.\d+\.\d+|6\.0\.[0-5])'
