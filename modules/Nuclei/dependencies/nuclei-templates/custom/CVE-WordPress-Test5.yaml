id: CVE-2qwewqe
info:
  name: WordPress HTML API Stored XSS (CVE-2024-6307) on 6.4.5
  author: Security Researcher
  severity: medium
  description: |
    Detects WordPress sites running version 6.4.5 which are vulnerable to a Stored 
    Cross‑Site Scripting flaw in the HTML API (fixed in 6.5.5). Authenticated attackers 
    (contributor+ level) can inject arbitrary scripts via insufficiently sanitized URLs. 
    Sites still on 6.4.5 should be upgraded immediately.  
  tags:
    - cve
    - wordpress
    - xss
    - html-api
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-6307
    - https://wpscan.com/wordpress/64/ :contentReference[oaicite:1]{index=1}
requests:
  - method: GET
    path:
      - "{{BaseURL}}/"
      - "{{BaseURL}}/readme.html"
    matchers:
      - type: regex
        part: body
        regex:
          # generator tag fingerprint
          - `<meta\s+name="generator"\s+content="WordPress\s+6\.4\.5"`
      - type: regex
        part: body
        regex:
          # readme fallback
          - `Version[: ]+6\.4\.5`
